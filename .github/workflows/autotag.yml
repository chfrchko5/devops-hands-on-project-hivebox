name: auto increment tag for python app

on:
    push:
        branches:
            - feature/github-actions-file
        paths:
            - 'hivebox-app/**'

jobs:
    auto-tag:
        runs-on: ubuntu-latest

        steps:
            - name: checkout repo
              uses: actions/checkout@v4

            - name: python linter
              uses: super-linter/super-linter@v8.2.0
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                VALIDATE_PYTHON: true
                DEFAULT_BRANCH: feature/github-actions-file
            
            - name: auto tag
              uses: mathieudutour/github-tag-action@v6.2
              id: tag_version
              with:
                github_token: ${{ secrets.GITHUB_TOKEN }}
                release_branches: main

            - name: create github release from tag
              uses: ncipollo/release-action@v1
              with:
                tag: ${{ steps.tag_version.outputs.new_tag }}
                name: Release ${{ steps.tag_version.outputs.new_tag }}
                body: ${{ steps.tag_version.outputs.changelog }}